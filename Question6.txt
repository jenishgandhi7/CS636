Script started on Fri 06 Mar 2020 11:32:15 PM EST
jenish@topcat:~/cs636$ sqlplus jenish/jenish@//dbs3.cs.umb.edu/dbs3

SQL*Plus: Release 12.1.0.2.0 Production on Fri Mar 6 23:32:17 2020

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

Last Successful login time: Fri Mar 06 2020 23:02:47 -05:00

Connected to:
Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options

SQL> set echo on;
SQL> @question6.sql
SQL> --a. Find all users (user_id's) with email addresses ending with "gmail.com".
SQL> --query 1)
SQL> select s.user_id from site_user s where s.email_address like '%@gmail.com';

   USER_ID
----------
	10
	 1

SQL> 
SQL> --query 2)
SQL> select * from site_user where email_address like '%@gmail.com';

   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------
	 1 John

   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------
Smith

   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------
jsmith@gmail.com

   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------
	10 Jenish

   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------
Gandhi

   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------
jenish.gandhi7@gmail.com

   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


   USER_ID FIRSTNAME
---------- --------------------------------------------------
LASTNAME
--------------------------------------------------
EMAIL_ADDRESS
--------------------------------------------------
COMPANY_NAME
--------------------------------------------------
ADDRESS1
--------------------------------------------------
ADDRESS2
--------------------------------------------------
CITY
--------------------------------------------------
STATE
--------------------------------------------------
ZIP
--------------------------------------------------
COUNTRY
--------------------------------------------------
CREDITCARD_TYPE
--------------------------------------------------
CREDITCARD_NUMBER
--------------------------------------------------
CREDITCARD_EXPIRATIONDATE
--------------------------------------------------


SQL> 
SQL> 
SQL> 
SQL> --b. Find all lineitems of invoice 2 and list their product id and quantity.
SQL> 
SQL> select product_id, quantity  from lineitem where invoice_id = 2;

PRODUCT_ID   QUANTITY
---------- ----------
	 2	    1
	 4	    1

SQL> 
SQL> --c. List all the downloads (product id, filename, and date) for the user with email andi@murach.com.
SQL> select product_id ,sample_filename, download_date from site_user s, download d, track t
  2  where s.user_id =d.user_id  and  d.track_id =t.track_id  and s.email_address = 'andi@murach.com';

PRODUCT_ID
----------
SAMPLE_FILENAME
--------------------------------------------------------------------------------
DOWNLOAD_DATE
---------------------------------------------------------------------------
	 4
filter.mp3
30-AUG-09 09.34.00.000000 AM


SQL> 
SQL> --d. There are no invoices in the tables in the original load, making it hard to test queries involving invoices.
SQL> Fix this problem by inserting an invoice with id =2 (dated 9/2/10, for user 2) with lineitems for products with product codes pf01 and jr01.  Show the three insert statements in your hw paper.
SP2-0734: unknown command beginning "Fix this p..." - rest of line ignored.
SQL> INSERT into invoice VALUES (2,2, timestamp '2010-09-02 00:00:00', 14.95,'Y');
INSERT into invoice VALUES (2,2, timestamp '2010-09-02 00:00:00', 14.95,'Y')
*
ERROR at line 1:
ORA-00001: unique constraint (JENISH.SYS_C00216675) violated


SQL> INSERT INTO lineitem (lineitem_id, invoice_id, product_id, quantity) VALUES (1,2,2,1);
INSERT INTO lineitem (lineitem_id, invoice_id, product_id, quantity) VALUES (1,2,2,1)
*
ERROR at line 1:
ORA-00001: unique constraint (JENISH.SYS_C00216681) violated


SQL> INSERT INTO lineitem (lineitem_id, invoice_id, product_id, quantity) VALUES (2,2,4,1);
INSERT INTO lineitem (lineitem_id, invoice_id, product_id, quantity) VALUES (2,2,4,1)
*
ERROR at line 1:
ORA-00001: unique constraint (JENISH.SYS_C00216681) violated


SQL> 
SQL> --e. List all invoice ids and invoice dates for the user with email andi@murach.com.
SQL> 
SQL> select invoice_id, INVOICE_DATE from site_user s, INVOICE i where s.user_id = i.user_id and s.email_address = 'andi@murach.com';

INVOICE_ID
----------
INVOICE_DATE
---------------------------------------------------------------------------
	 2
02-SEP-10 12.00.00.000000 AM


SQL> 
SQL> --f. Find all product ids purchased by the user with email andi@murach.com (i.e., find the lineitems)
SQL> 
SQL> select product_id from site_user s, INVOICE i , lineitem l where s.user_id = i.user_id and i.invoice_id = l.invoice_id and s.email_address = 'andi@murach.com';

PRODUCT_ID
----------
	 2
	 4

SQL> 
SQL> --g. Find all products (product codes) where a download preceded a purchase. Avoid duplicates in the result.
SQL> 
SQL> SELECT distinct product_code FROM download d1, lineitem l1, invoice i1, product p1
  2  where d1.user_id=i1.user_id and l1.invoice_id=i1.invoice_id and p1.product_id=l1.product_id and d1.download_date < i1.invoice_date;

PRODUCT_CO
----------
pf01
jr01

SQL> 
SQL> 
SQL> --h. Find the downloaded file (.mp3 filename) that was downloaded the highest number of times.
SQL> 
SQL> 
SQL> select t.sample_filename from track t, download d where d.track_id = t.track_id and t.sample_filename like '%.mp3%'
  2  group by t.track_id, t.sample_filename
  3  having count(*) IN (select max(count(*)) from download d1 group by d1.track_id);

SAMPLE_FILENAME
--------------------------------------------------------------------------------
so_long.mp3
filter.mp3

SQL> 
SQL> 
SQL> -- i. Report on the number of downloads (total over all files for that CD) by CD product code, since August 1, 2009.
SQL> 
SQL> select product_code, count(*) as Total from product p, track t, download d
  2  where p.product_id= t.product_id and t.track_id=d.track_id
  3  and d.download_date >= timestamp '2009-08-01 00:00:00.0'
  4  group by p.product_id, p.product_code
  5  ;

PRODUCT_CO	TOTAL
---------- ----------
jr01		    3

SQL> exit
Disconnected from Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options
jenish@topcat:~/cs636$ exit
exit

Script done on Fri 06 Mar 2020 11:32:44 PM EST
